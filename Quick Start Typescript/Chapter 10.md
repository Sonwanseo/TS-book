# Chapter 10. 타입 선언과 변경, 타입 호환

## 10.1 타입 선언과 변경

### 10.1.1 타입 에일리어스

##### 타입 에일리어스를 이용한 단일 타입 선언

타입 에일리어스는 타입스크립트 1.4 버전부터 지원된 특징  
타입 에일리어스를 이용하면 기존 타입에 새로운 이름을 지을 수 있음  
type <바인딩 식별자> = 타입;

바인딩 식별자는 타입의 별칭에 해당하는 타입 에일리어스

```typescript
type myId = string;
```

이처럼 타입에 새로운 별칭을 만드는 과정을 줄여서 에일리어싱이라 함

에일리어싱을 할 때 고려할 점은 에일리어싱할 타입이 단일 타입인 경우 타입 별칭이 많아질 뿐 특별한 이점은 X

단일 타입에 대해 타입 에일리어스를 선언해 사용하는 것은 복잡해 보이므로 그 경우에는 타입 에일리어스를 사용하지 않는 것이 직관적

##### 타입 에일리어스를 이용한 유니언 타입 선언

타입 에일리어스는 단일 타입보다는 유니언 타입이나 리터럴 타입과 같은 다소 복잡한 형태의 타입에 적용하는 것이 좋음

새롭게 정의된 타입은 변수 등의 타입 지정에 사용할 수 있고 새로운 타입 에일리어스를 선언할 때도 사용 가능

##### 타입 에일리어스를 이용한 배열 선언

배열은 하나의 변수에 여러 값을 관리할 수 있는 효율적인 자료형  
배열에 입력되는 값은 대체로 같은 타입을 갖지만, 때로는 문자열 "true"와 불리언 true처럼 입력할 때 구분 하기가 모호한 경우가 있음  
이러한 경우 typeof를 이용해 문자인지 숫자인지 확인해서 입력받아야 함

### 10.1.2 타입 추론

타입스크립트에서는 값을 할당할 때 타입을 명시하지 않으면 타입 추론을 통해 타입이 결정됨

### 10.1.3 타입 캐스팅, 변환, 어설션

타입 캐스팅은 명시적으로 선언한 캐스팅 코드에 의한 타입 변경을 의미하며, JS 인터프리터에 의해 타입이 바뀌는 타입 변환과 구분됨  
타입 캐스팅의 예로, null이나 undefined를 제외한 인수 값은 기본 래퍼 객체를 이용해 캐스팅할 수 있음  
기본 래퍼 객체는 함수 호출 방식으로 사용하며 다음과 같은 종류가 있음

- String
- Number
- Boolean
- Symbol

타입을 변경할 기본 래퍼 객체 외에도 + 연산자를 이용할 수 있는데, 이는 Number 함수를 호출하는 방법과 같음  
그리고 parseInt를 이용해 숫자가 포함된 문자열을 숫자 타입으로 변경할 수 있음  
다만, parseInt 함수가 Number 함수와 다른 점이 있다면 parseInt는 함수 이름처럼 파싱 기능이 있어 숫자 외에 여러 문자가 섞여 있을 때 숫자만을 골라서 숫자 타입으로 변경할 수 있다는 점

##### 타입 어설션

타입 어설션을 이용하면 타입스크립트가 타입 어설션 정보를 이용해 컴파일을 수행  
따라서 타입 어설션은 컴파일 과정까지만 유효하고 컴파일 후에는 사라짐  
타입 어설션의 선언 방시근 크게 꺾쇠 괄호 방식과 as 문법을 이용한 방식이 있음

```typescript
let num1: number = <number>myNum;
let num2: number = myNum as number;
```

위 코드에서 할당에 사용된 myNum 변수는 본래 any 타입이지만 어설션<number>로 돼 있으므로 컴파일러가 number 타입으로 인식함

타입 어설션은 컴파일러에게 전달되는 타입 정보이므로 컴파일러는 타입 어설션을 보고 유효성을 검증함  
예를 들어 타입이 지정된 변수와 타입 어설션이 선언된 변수 간에는 유효성에 문제가 없으면 두 변수 간에 타입 호환이 이루어짐

## 10.2 타입 호환

### 10.2.1 프로그래밍 언어의 타입 시스템

프로그래밍 언어는 타입 시스템을 갖춤으로써 컴파일 시점에 타입 검사를 통해 타입에서 비롯되는 오류를 방지  
프로그래밍 언어마다 타입 검사 시점이 다른데 타입 검사는 크게 두 가지 방식으로 나뉨

- 동적 타입 검사
- 정적 타입 검사

자바스크립트 같은 동적 프로그래밍 언어는 런타임 시점에 동적 타입 검사를 수행하고, 타입스크립트 같은 정적 언어는 컴파일 시점에 정적 타입 검사를 수행

타입스크립트는 두 부류의 타입 시스템을 모두 지원함

- 구조 타입 시스템
- 명목 타입 시스템

구조 타입 시스템이나 명목 타입 시스템은 타입 호환 방식에 다소 차이가 있음  
구조 타입 시스템은 타입의 구조와 정의만 같다면 타입 호환이 가능  
이와 달리 명목 타입 시스템은 타입 호환이 되려면 명시적으로 같은 타입이어야 함

타입스크립트가 지원하는 타이핑 방식

- 덕 타이핑
- 구조 타이핑
- 구조 서브타이핑
- 명목 타이핑

덕 타이핑 = 런타임 시 동적으로 타입의 구조가 정해지는 타입 지정 방식  
구조 타이핑 = 타입의 구조만 같으면 서로 호환이 가능한 타입 지정 방식  
구조 서브타이핑 = 구조가 부분적으로 같더라도 타입 호환 지원
명목 타이핑 = 타입 구조뿐 아니라 타입까지 같아야 호환 가능한 타입 지정 방식

|구분|구조 타이핑|구조 서브타이핑|
|타입 호환 상황|두 타입의 구조가 같으면 타입 호환 (타입 A = 타입 B, 타입 B = 타입 A)|구조가 부분적으로 같으면 타입 호환 단, 하위 타입에서 상위 타입으로 타입 호환이 됨|
|타입 호환 예|클래스 간의 타입 호환 클래스와 인터페이스 간의 타입 호환|함수 간의 타입 호환 객체 리터럴과 인터페이스 간의 타입 호환 객체 리터럴에 타입 에일리어스를 적용해 타입 호환|

### 10.2.2 덕 타이핑

덕 타이핑은 동적 타이핑 방식으로서 자바스크립트 코드의 런타임 시 동적으로 타이핑이 이뤄지는 타입 지정 방식

덕 타이핑은 동적으로 타입이 결정되므로 유연하지만 타입 안전성은 떨어짐

만약, 덕 타이핑을 할 때 타입 안정성을 강화하려면 인터페이스를 도입

매개변수로 입력될 객체의 행동은 인터페이스 타입으로 제한 가능  
이때 인터페이스로 입력되는 객체의 클래스가 서브 클래스이고 슈퍼 클래스를 대체할 수 있을 때 서브타이핑이 됨

### 10.2.3 구조 타이핑

타입스크립트는 컴파일 시간에 타입 호환이 가능한지 검사  
타입 호환이 가능하면 컴파일을 통과시키고 타입 호환이 불가능하면 컴파일 오류를 출력  
이처럼 타입스크립트는 타입 안정성을 위해 컴파일 시간에 타입 검사를 수행  
그러나 모든 타입에 타입 검사가 이뤄지는 것은 아님

##### 구조가 같은 클래스 간의 구조 타이핑

구조가 같은 클래스 간에는 서로 타입 호환이 가능해서 서로의 타입으로 구조 타이핑이 가능

##### 구조가 같은 클래스 간의 구조 타이핑(상속 관계 고려)

부모를 가진 자식 클래스와 같은 구조의 클래스가 있다면 이 두 클래스는 구조 타이핑이 가능

##### 구조가 같은 클래스와 인터페이스 간의 구조 타이핑

클래스와 인터페이스의 구조가 같다면 타입 호환이 가능해 서로의 타입으로 구조 타이핑이 가능

### 10.2.4 구조 서브타이핑

구조 타이핑은 타입 구조가 같아야지만 타입 호환이 이뤄지지만, 구조 서브타이핑은 구조가 부분적으로 같더라도 타입 호환을 지원

##### 구조 서브타이핑의 조건

구조 서브타이핑은 하위 타입이 상위 타입으로만 호환되는 조건이 있음  
여기서 말하는 상위 타입은 타이핑 관점에서 공통되는 구조(변수 메서드 등)가 들어있는 기본 형태이고, 하위 타입은 상위 타입을 포함하면서 구조가 보태어진 특정한 형태를 의미

하위 타입은 상위 타입의 속성을 포함  
이때 "상위 타입 = 하위 타입"처럼 하위 타입을 상위 타입에 대입하는 것으로 구조 서브타이핑이 가능

##### 타입이 없지만 구조가 일부 같은 변수 간의 구조 서브타이핑

구조가 일부 같으면 타입이 없더라도 변수 간의 구조 서브타이핑이 가능

##### 매개변수 개수가 다른 함수 타입 간의 구조 서브타이핑

타입스크립트에서는 함수에 선언된 매개변수 개수와 호출 시 전달하는 인수의 개수가 다르면 오류가 발생

반면 자바스크립트에서는 함수의 매개변수 개수와 전달하는 인수의 개수가 다르더라도 함수의 연산에 영향을 주지 않는 매개변수가 생략된 경우라면 인수를 전달하지 않아도 괜찮음

함수 타입의 구조 서브타이핑에서는 예외적으로 "상위 타입 = 하위 타입' 형태의 타입 호환이 되지 않고, "하위 타입 = 상위 타입" 형태로 할당이 이루어짐  
따라서 매개변수가 적은 상위 함수 타입이 매개변수가 많은 하위 함수 타입으로 타입 호환이 가능함

##### 구조가 일부 같은 객체와 인터페이스 간의 구조 서브타이핑

객체 리터럴이 할당된 변수에 인터페이스 타입을 지정하면 해당 변수는 구조 서브타이핑이 적용됨

### 10.2.5 명목 타이핑

명목 나이핑은 자바나 C++, C#과 같은 전통적인 언어에서 사용하는 타이핑 방식으로 명시적으로 지정된 타입 간에만 타입이 호환됨  
명목 타이핑에 대한 예로 Enum이 있음  
같은 Enum 타입으로 지정된 변수 간에만 타입이 호환됨
